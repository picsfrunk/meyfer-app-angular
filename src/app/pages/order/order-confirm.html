<div class="order-form-container">
  <nz-card class="order-card" nzTitle="Confirmación del Pedido">
    <form nz-form [formGroup]="orderForm" (ngSubmit)="submitForm()">

      <!-- DATOS DEL CLIENTE -->
      <section class="form-section">
        <h4 nz-typography>Datos del Cliente</h4>
        <nz-divider></nz-divider>

        <div class="form-grid">
          <nz-form-item>
            <nz-form-label nzRequired nzFor="cliente">Cliente</nz-form-label>
            <nz-form-control nzErrorTip="Ingrese el nombre del cliente">
              <input nz-input formControlName="cliente" id="cliente" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label nzFor="razonSocial">Razón Social</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="razonSocial" id="razonSocial" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label nzFor="cuit">CUIT</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="cuit" id="cuit" placeholder="20-12345678-9" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label nzFor="telefono1">Teléfono</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="telefono1" id="telefono1" placeholder="+54..." />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label nzFor="email">Email</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="email" id="email" type="email" placeholder="ejemplo@mail.com" />
            </nz-form-control>
          </nz-form-item>
        </div>
      </section>

      <!-- DIRECCIÓN DE ENTREGA (IMPORTANTE: formGroupName restaurado) -->
      <section class="form-section">
        <h4 nz-typography>Dirección de Entrega</h4>
        <nz-divider></nz-divider>

        <!-- <<< aquí aplicamos formGroupName para que Angular encuentre los controles anidados -->
        <div formGroupName="direccion" class="form-grid">
          <nz-form-item>
            <nz-form-label nzFor="calle">Calle</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="calle" id="calle" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label nzFor="numero">Número</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="numero" id="numero" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label nzFor="piso">Piso / Depto</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="piso" id="piso" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label nzFor="timbre">Timbre</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="timbre" id="timbre" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label nzFor="entreCalles">Entre Calles</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="entreCalles" id="entreCalles" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label nzFor="localidad">Localidad</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="localidad" id="localidad" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label nzFor="partido">Partido</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="partido" id="partido" />
            </nz-form-control>
          </nz-form-item>
        </div>
      </section>

      <!-- CONTACTO -->
      <section class="form-section">
        <h4 nz-typography>Contacto y Horarios</h4>
        <nz-divider></nz-divider>

        <div class="form-grid">
          <nz-form-item>
            <nz-form-label nzRequired nzFor="contacto">Contacto</nz-form-label>
            <nz-form-control nzErrorTip="Ingrese el contacto">
              <input nz-input formControlName="contacto" id="contacto" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item>
            <nz-form-label nzFor="horarios">Horarios</nz-form-label>
            <nz-form-control>
              <input nz-input formControlName="horarios" id="horarios" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item class="notas">
            <nz-form-label nzFor="notas">Notas</nz-form-label>
            <nz-form-control>
              <textarea nz-input formControlName="notas" id="notas" rows="3" placeholder="Indicaciones adicionales..."></textarea>
            </nz-form-control>
          </nz-form-item>
        </div>
      </section>

      <!-- RESUMEN -->
      <section class="form-section resumen">
        <h4 nz-typography>Resumen del Pedido</h4>
        <nz-divider></nz-divider>
        <div class="summary-container">
          <div class="summary-item">
            <span nzType="secondary">Cantidad de Productos</span>
            <nz-tag nzColor="processing">{{ cartCount() }}</nz-tag>
          </div>
          <div class="summary-item total">
            <span>Total</span>
            <span class="total-price">{{ cartTotal() | currency: 'ARS' : 'symbol' }}</span>
          </div>
        </div>
      </section>

      <div class="form-footer">
        <button nz-button nzType="primary" [nzLoading]="isFormLoading">
          Confirmar Pedido
        </button>
      </div>
    </form>
  </nz-card>
</div>
