<div class="product-list-container">
  <h1>Cat√°logo de Productos</h1>

  <div class="search-bar" style="margin-bottom: 1rem;">
    <nz-input-group [nzSuffix]="suffixIcon">
      <input
        type="text"
        nz-input
        placeholder="Buscar productos..."
        [value]="searchTerm()"
        (input)="searchTerm.set($any($event.target).value); loadProducts()"
      />
    </nz-input-group>
    <ng-template #suffixIcon>
      <span nz-icon nzType="search"></span>
    </ng-template>
  </div>

  <nz-spin [nzSpinning]="isLoading()">
    <div class="product-grid">
      @for (product of displayProducts; track product.product_id) {
<!--        Products Grid      -->
        <nz-card class="product-card" [nzBordered]="true" [nzHoverable]="true">
          <div class="product-image-container">
            <img
              nz-card-cover
              [src]="product.image_url || 'assets/no-image.png'"
              [alt]="product.display_name"
              class="product-image"
              loading="lazy"
            />
          </div>

          <div class="product-info-body">
            <h3 class="product-title">{{ product.display_name }}</h3>
            <div class="product-details">
              <p class="product-unit">{{ product.base_unit_name }}</p>
              <p class="product-price">{{ product.list_price | currency: 'ARS' : 'symbol' }}</p>
            </div>
          </div>

          <ul nz-card-actions class="card-actions">
            <li>
              <button nz-button nzType="primary" (click)="addToCart(product)">
                <span nz-icon nzType="shopping-cart"></span>
                Agregar
              </button>
            </li>
          </ul>
        </nz-card>
      }
    </div>
  </nz-spin>

  <div class="pagination-container">
    <nz-pagination
      [nzPageIndex]="page()"
      [nzPageSize]="limit()"
      [nzTotal]="total"
      (nzPageIndexChange)="onPageIndexChange($event)"
    ></nz-pagination>
  </div>
</div>
